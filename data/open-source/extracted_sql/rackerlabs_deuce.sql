CREATE TABLE files ( projectid TEXT, vaultid TEXT, fileid UUID, size BIGINT, finalized BOOLEAN, PRIMARY KEY((projectid, vaultid), fileid))
CREATE TABLE blockfiles ( projectid TEXT, vaultid TEXT, fileid UUID, blockid TEXT, PRIMARY KEY(projectid, vaultid, blockid))
CREATE TABLE files ( projectid TEXT NOT NULL, vaultid TEXT NOT NULL, fileid TEXT NOT NULL, finalized INTEGER NOT NULL DEFAULT 0, size INTEGER DEFAULT 0, PRIMARY KEY(projectid, vaultid, fileid) )
CREATE TABLE vaults ( projectid TEXT, vaultid TEXT, PRIMARY KEY(projectid, vaultid))
CREATE TABLE blocks ( projectid TEXT, vaultid TEXT, blockid TEXT, storageid TEXT, blocksize INT, reftime DATETIME, isinvalid BOOLEAN, PRIMARY KEY(projectid, vaultid, blockid))
CREATE TABLE vaults( projectid TEXT, vaultid TEXT, PRIMARY KEY(projectid, vaultid))
CREATE TABLE fileblocks ( projectid TEXT NOT NULL, vaultid TEXT NOT NULL, fileid TEXT NOT NULL, blockid TEXT NOT NULL, offset INTEGER NOT NULL, UNIQUE (projectid, vaultid, fileid, blockid, offset) )
CREATE TABLE vaults ( projectid TEXT NOT NULL, vaultid TEXT NOT NULL, PRIMARY KEY(projectid, vaultid) )
CREATE TABLE fileblocks ( projectid TEXT, vaultid TEXT, fileid TEXT, blockid TEXT, blocksize INT, offset INT, PRIMARY KEY(projectid, vaultid, fileid, offset))
CREATE TABLE blocks ( projectid TEXT NOT NULL, vaultid TEXT NOT NULL, blockid TEXT NOT NULL, storageid TEXT NOT NULL, size INTEGER NOT NULL, reftime DATETIME NOT NULL, isinvalid BOOLEAN NOT NULL DEFAULT 0, PRIMARY KEY(projectid, vaultid, blockid) )
CREATE TABLE files ( projectid TEXT, vaultid TEXT, fileid TEXT, size INT, finalized BOOLEAN, PRIMARY KEY(projectid, vaultid, fileid))
UPDATE blocks SET isinvalid = 1  WHERE projectid = :projectid
CREATE TABLE fileblocks ( projectid TEXT, vaultid TEXT, fileid UUID, blockid TEXT, blocksize INT, offset BIGINT, PRIMARY KEY((projectid, vaultid, fileid), offset))
CREATE TABLE blockfiles ( projectid TEXT, vaultid TEXT, fileid TEXT, blockid TEXT, PRIMARY KEY(projectid, vaultid, fileid, blockid))
CREATE TABLE blockreferences ( projectid TEXT, vaultid TEXT, blockid TEXT, refcount INTEGER, PRIMARY KEY(projectid, vaultid, blockid))
