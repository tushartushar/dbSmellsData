CREATE TABLE `intended_uses` ( `id` int(11) NOT NULL AUTO_INCREMENT, `description` varchar(255) COLLATE utf8_unicode_ci DEFAULT NULL, `is_internal_use_only` tinyint(1) NOT NULL DEFAULT '0', `is_approved` tinyint(1) NOT NULL DEFAULT '0', `created_at` datetime DEFAULT NULL, `updated_at` datetime DEFAULT NULL, `units_count` int(11) DEFAULT '0', `deliverable_format` varchar(255) COLLATE utf8_unicode_ci DEFAULT NULL, `deliverable_resolution` varchar(255) COLLATE utf8_unicode_ci DEFAULT NULL, `deliverable_resolution_unit` varchar(255) COLLATE utf8_unicode_ci DEFAULT NULL, PRIMARY KEY (`id`), UNIQUE KEY `index_intended_uses_on_description` (`description`))
select count(*) from bibls where call_number like 'MSS%';
CREATE TABLE `bibls_legacy_identifiers` ( `legacy_identifier_id` int(11) DEFAULT NULL, `bibl_id` int(11) DEFAULT NULL, KEY `index_bibls_legacy_identifiers_on_bibl_id` (`bibl_id`), KEY `index_bibls_legacy_identifiers_on_legacy_identifier_id` (`legacy_identifier_id`), CONSTRAINT `bibls_legacy_identifiers_bibl_id_fk` FOREIGN KEY (`bibl_id`) REFERENCES `bibls` (`id`), CONSTRAINT `bibls_legacy_identifiers_legacy_identifier_id_fk` FOREIGN KEY (`legacy_identifier_id`) REFERENCES `legacy_identifiers` (`id`))
CREATE TABLE `invoices` ( `id` int(11) NOT NULL AUTO_INCREMENT, `order_id` int(11) NOT NULL DEFAULT '0', `date_invoice` datetime DEFAULT NULL, `invoice_content` text COLLATE utf8_unicode_ci, `created_at` datetime DEFAULT NULL, `updated_at` datetime DEFAULT NULL, `invoice_number` int(11) DEFAULT NULL, `fee_amount_paid` int(11) DEFAULT NULL, `date_fee_paid` datetime DEFAULT NULL, `date_second_notice_sent` datetime DEFAULT NULL, `transmittal_number` text COLLATE utf8_unicode_ci, `notes` text COLLATE utf8_unicode_ci, `invoice_copy` mediumblob, `permanent_nonpayment` tinyint(1) DEFAULT '0', PRIMARY KEY (`id`), KEY `index_invoices_on_order_id` (`order_id`), CONSTRAINT `invoices_order_id_fk` FOREIGN KEY (`order_id`) REFERENCES `orders` (`id`))
CREATE TABLE `sql_reports` ( `id` int(11) NOT NULL AUTO_INCREMENT, `name` varchar(255) COLLATE utf8_unicode_ci DEFAULT NULL, `description` varchar(255) COLLATE utf8_unicode_ci DEFAULT NULL, `sql` text COLLATE utf8_unicode_ci, `created_at` datetime DEFAULT NULL, `updated_at` datetime DEFAULT NULL, PRIMARY KEY (`id`))
CREATE TABLE `components_legacy_identifiers` ( `component_id` int(11) DEFAULT NULL, `legacy_identifier_id` int(11) DEFAULT NULL, KEY `component_id` (`component_id`), KEY `legacy_identifier_id` (`legacy_identifier_id`), CONSTRAINT `components_legacy_identifiers_ibfk_1` FOREIGN KEY (`component_id`) REFERENCES `components` (`id`), CONSTRAINT `components_legacy_identifiers_ibfk_2` FOREIGN KEY (`legacy_identifier_id`) REFERENCES `legacy_identifiers` (`id`))
CREATE TABLE `academic_statuses` ( `id` int(11) NOT NULL AUTO_INCREMENT, `name` varchar(255) DEFAULT NULL, `created_at` datetime DEFAULT NULL, `updated_at` datetime DEFAULT NULL, `customers_count` int(11) DEFAULT '0', PRIMARY KEY (`id`), UNIQUE KEY `index_academic_statuses_on_name` (`name`))
CREATE TABLE `versions` ( `id` int(11) NOT NULL AUTO_INCREMENT, `item_type` varchar(255) COLLATE utf8_unicode_ci NOT NULL, `item_id` int(11) NOT NULL, `event` varchar(255) COLLATE utf8_unicode_ci NOT NULL, `whodunnit` varchar(255) COLLATE utf8_unicode_ci DEFAULT NULL, `object` text COLLATE utf8_unicode_ci, `created_at` datetime DEFAULT NULL, PRIMARY KEY (`id`), KEY `index_versions_on_item_type_and_item_id` (`item_type`,`item_id`))
select count(*) from metadata
CREATE TABLE `legacy_identifiers_master_files` ( `legacy_identifier_id` int(11) DEFAULT NULL, `master_file_id` int(11) DEFAULT NULL, KEY `index_legacy_identifiers_master_files_on_legacy_identifier_id` (`legacy_identifier_id`), KEY `index_legacy_identifiers_master_files_on_master_file_id` (`master_file_id`), CONSTRAINT `legacy_identifiers_master_files_legacy_identifier_id_fk` FOREIGN KEY (`legacy_identifier_id`) REFERENCES `legacy_identifiers` (`id`), CONSTRAINT `legacy_identifiers_master_files_master_file_id_fk` FOREIGN KEY (`master_file_id`) REFERENCES `master_files` (`id`))
CREATE TABLE `departments` ( `id` int(11) NOT NULL AUTO_INCREMENT, `name` varchar(255) COLLATE utf8_unicode_ci DEFAULT NULL, `created_at` datetime DEFAULT NULL, `updated_at` datetime DEFAULT NULL, `customers_count` int(11) DEFAULT '0', PRIMARY KEY (`id`), UNIQUE KEY `index_departments_on_name` (`name`))
CREATE TABLE `addresses` ( `id` int(11) NOT NULL AUTO_INCREMENT, `addressable_id` int(11) NOT NULL, `addressable_type` varchar(20) COLLATE utf8_unicode_ci NOT NULL, `address_type` varchar(20) COLLATE utf8_unicode_ci NOT NULL, `last_name` varchar(255) COLLATE utf8_unicode_ci DEFAULT NULL, `first_name` varchar(255) COLLATE utf8_unicode_ci DEFAULT NULL, `address_1` varchar(255) COLLATE utf8_unicode_ci DEFAULT NULL, `address_2` varchar(255) COLLATE utf8_unicode_ci DEFAULT NULL, `city` varchar(255) COLLATE utf8_unicode_ci DEFAULT NULL, `state` varchar(255) COLLATE utf8_unicode_ci DEFAULT NULL, `country` varchar(255) COLLATE utf8_unicode_ci DEFAULT NULL, `post_code` varchar(255) COLLATE utf8_unicode_ci DEFAULT NULL, `phone` varchar(255) COLLATE utf8_unicode_ci DEFAULT NULL, `organization` varchar(255) COLLATE utf8_unicode_ci DEFAULT NULL, `created_at` datetime NOT NULL, `updated_at` datetime NOT NULL, PRIMARY KEY (`id`))
CREATE TABLE `indexing_scenarios` ( `id` int(11) NOT NULL AUTO_INCREMENT, `name` varchar(255) COLLATE utf8_unicode_ci DEFAULT NULL, `pid` varchar(255) COLLATE utf8_unicode_ci DEFAULT NULL, `datastream_name` varchar(255) COLLATE utf8_unicode_ci DEFAULT NULL, `repository_url` varchar(255) COLLATE utf8_unicode_ci DEFAULT NULL, `created_at` datetime DEFAULT NULL, `updated_at` datetime DEFAULT NULL, `bibls_count` int(11) DEFAULT '0', `components_count` int(11) DEFAULT '0', `master_files_count` int(11) DEFAULT '0', `units_count` int(11) DEFAULT '0', PRIMARY KEY (`id`))
CREATE TABLE `legacy_identifiers` ( `id` int(11) NOT NULL AUTO_INCREMENT, `label` varchar(255) COLLATE utf8_unicode_ci DEFAULT NULL, `description` varchar(255) COLLATE utf8_unicode_ci DEFAULT NULL, `legacy_identifier` varchar(255) COLLATE utf8_unicode_ci DEFAULT NULL, `created_at` datetime DEFAULT NULL, `updated_at` datetime DEFAULT NULL, PRIMARY KEY (`id`), KEY `index_legacy_identifiers_on_label` (`label`), KEY `index_legacy_identifiers_on_legacy_identifier` (`legacy_identifier`))
CREATE TABLE `availability_policies` ( `id` int(11) NOT NULL AUTO_INCREMENT, `name` varchar(255) COLLATE utf8_unicode_ci DEFAULT NULL, `bibls_count` int(11) DEFAULT '0', `components_count` int(11) DEFAULT '0', `master_files_count` int(11) DEFAULT '0', `units_count` int(11) DEFAULT '0', `created_at` datetime NOT NULL, `updated_at` datetime NOT NULL, `repository_url` varchar(255) COLLATE utf8_unicode_ci DEFAULT NULL, `pid` varchar(255) COLLATE utf8_unicode_ci DEFAULT NULL, PRIMARY KEY (`id`))
CREATE TABLE `use_rights` ( `id` int(11) NOT NULL AUTO_INCREMENT, `name` varchar(255) COLLATE utf8_unicode_ci DEFAULT NULL, `description` varchar(255) COLLATE utf8_unicode_ci DEFAULT NULL, `created_at` datetime DEFAULT NULL, `updated_at` datetime DEFAULT NULL, `bibls_count` int(11) DEFAULT '0', `components_count` int(11) DEFAULT '0', `master_files_count` int(11) DEFAULT '0', `units_count` int(11) DEFAULT '0', PRIMARY KEY (`id`), UNIQUE KEY `index_use_rights_on_name` (`name`))
CREATE TABLE `bibls_components` ( `bibl_id` int(11) DEFAULT NULL, `component_id` int(11) DEFAULT NULL, KEY `bibl_id` (`bibl_id`), KEY `component_id` (`component_id`), CONSTRAINT `bibls_components_ibfk_1` FOREIGN KEY (`bibl_id`) REFERENCES `bibls` (`id`), CONSTRAINT `bibls_components_ibfk_2` FOREIGN KEY (`component_id`) REFERENCES `components` (`id`))
CREATE TABLE `component_types` ( `id` int(11) NOT NULL AUTO_INCREMENT, `name` varchar(255) COLLATE utf8_unicode_ci DEFAULT NULL, `description` varchar(255) COLLATE utf8_unicode_ci DEFAULT NULL, `created_at` datetime DEFAULT NULL, `updated_at` datetime DEFAULT NULL, `components_count` int(11) DEFAULT NULL, PRIMARY KEY (`id`), UNIQUE KEY `index_component_types_on_name` (`name`))
CREATE TABLE `containers` ( `id` int(11) NOT NULL AUTO_INCREMENT, `barcode` varchar(255) COLLATE utf8_unicode_ci DEFAULT NULL, `container_type` varchar(255) COLLATE utf8_unicode_ci DEFAULT NULL, `label` varchar(255) COLLATE utf8_unicode_ci DEFAULT NULL, `sequence_no` varchar(255) COLLATE utf8_unicode_ci DEFAULT NULL, `parent_container_id` int(11) NOT NULL DEFAULT '0', `legacy_component_id` int(11) NOT NULL DEFAULT '0', `created_at` datetime DEFAULT NULL, `updated_at` datetime DEFAULT NULL, `container_type_id` int(11) DEFAULT NULL, PRIMARY KEY (`id`), KEY `containers_container_type_id_fk` (`container_type_id`), CONSTRAINT `containers_container_type_id_fk` FOREIGN KEY (`container_type_id`) REFERENCES `container_types` (`id`))
CREATE TABLE `container_types` ( `id` int(11) NOT NULL AUTO_INCREMENT, `name` varchar(255) COLLATE utf8_unicode_ci DEFAULT NULL, `description` varchar(255) COLLATE utf8_unicode_ci DEFAULT NULL, PRIMARY KEY (`id`), UNIQUE KEY `index_container_types_on_name` (`name`))
CREATE TABLE `staff_members` ( `id` int(11) NOT NULL AUTO_INCREMENT, `access_level_id` int(11) NOT NULL DEFAULT '0', `computing_id` varchar(255) COLLATE utf8_unicode_ci DEFAULT NULL, `last_name` varchar(255) COLLATE utf8_unicode_ci DEFAULT NULL, `first_name` varchar(255) COLLATE utf8_unicode_ci DEFAULT NULL, `is_active` tinyint(1) NOT NULL DEFAULT '0', `created_at` datetime DEFAULT NULL, `updated_at` datetime DEFAULT NULL, `automation_messages_count` int(11) DEFAULT '0', `email` varchar(255) COLLATE utf8_unicode_ci DEFAULT NULL, PRIMARY KEY (`id`), UNIQUE KEY `index_staff_members_on_computing_id` (`computing_id`), KEY `access_level_id` (`access_level_id`))
select count(*) from bibls as SC_COUNT where location not in ("3EAST", "BY-REQUEST", "Carr's Hill", "CATALOGING", "Center for Nursing Historical Inquiry", "CHECK-LOC", "DOC-US", "Heath Sciences Library", "Historical Collections Artifacts", "IVY-BOOK", "IVYANNEX", "JOURNALS", "LAW-IVY", "LOST", "LOSTCLOSED", "On loan from Oberlin College", "ORD-CLOSED", "Owned by Clifton McCleskey in Politics", "Personal Copy of Kathleen Wilson", "Personal Copy--Alison Booth", "personal item", "Personal Slide Collection", "REFATLAS", "REFERENCE", "SLIDES", "UCLA") and location is not NULL;
CREATE TABLE `legacy_identifiers_units` ( `legacy_identifier_id` int(11) DEFAULT NULL, `unit_id` int(11) DEFAULT NULL, KEY `units_legacy_ids_index` (`unit_id`,`legacy_identifier_id`))
CREATE TABLE `agencies` ( `id` int(11) NOT NULL AUTO_INCREMENT, `name` varchar(255) COLLATE utf8_unicode_ci DEFAULT NULL, `description` varchar(255) COLLATE utf8_unicode_ci DEFAULT NULL, `is_billable` tinyint(1) NOT NULL DEFAULT '0', `last_name` varchar(255) COLLATE utf8_unicode_ci DEFAULT NULL, `first_name` varchar(255) COLLATE utf8_unicode_ci DEFAULT NULL, `created_at` datetime DEFAULT NULL, `updated_at` datetime DEFAULT NULL, `ancestry` varchar(255) COLLATE utf8_unicode_ci DEFAULT NULL, `names_depth_cache` varchar(255) COLLATE utf8_unicode_ci DEFAULT NULL, `orders_count` int(11) DEFAULT '0', PRIMARY KEY (`id`), UNIQUE KEY `index_agencies_on_name` (`name`), KEY `index_agencies_on_ancestry` (`ancestry`))
CREATE TABLE `job_statuses` ( `id` int(11) NOT NULL AUTO_INCREMENT, `status` varchar(255) COLLATE utf8_unicode_ci NOT NULL DEFAULT 'pending', `started_at` datetime DEFAULT NULL, `ended_at` datetime DEFAULT NULL, `failures` int(11) NOT NULL DEFAULT '0', `error` varchar(255) COLLATE utf8_unicode_ci DEFAULT NULL, `backtrace` text COLLATE utf8_unicode_ci, `originator_id` int(11) DEFAULT NULL, `originator_type` varchar(255) COLLATE utf8_unicode_ci DEFAULT NULL, `created_at` datetime NOT NULL, `updated_at` datetime NOT NULL, PRIMARY KEY (`id`))
CREATE TABLE `schema_migrations` ( `version` varchar(255) COLLATE utf8_unicode_ci NOT NULL, UNIQUE KEY `unique_schema_migrations` (`version`))
select count(*) from bibls as CS_MSS_COUNT where location not in ("3EAST", "BY-REQUEST", "Carr's Hill", "CATALOGING", "Center for Nursing Historical Inquiry", "CHECK-LOC", "DOC-US", "Heath Sciences Library", "Historical Collections Artifacts", "IVY-BOOK", "IVYANNEX", "JOURNALS", "LAW-IVY", "LOST", "LOSTCLOSED", "On loan from Oberlin College", "ORD-CLOSED", "Owned by Clifton McCleskey in Politics", "Personal Copy of Kathleen Wilson", "Personal Copy--Alison Booth", "personal item", "Personal Slide Collection", "REFATLAS", "REFERENCE", "SLIDES", "UCLA") and location is not NULL and call_number like 'MSS%';
update master_files set text_source=2  where transcription_text is not null
CREATE TABLE `heard_about_services` ( `id` int(11) NOT NULL AUTO_INCREMENT, `description` varchar(255) COLLATE utf8_unicode_ci DEFAULT NULL, `created_at` datetime DEFAULT NULL, `updated_at` datetime DEFAULT NULL, `is_approved` tinyint(1) NOT NULL DEFAULT '0', `is_internal_use_only` tinyint(1) NOT NULL DEFAULT '0', `customers_count` int(11) DEFAULT '0', PRIMARY KEY (`id`), KEY `index_heard_about_services_on_description` (`description`))
CREATE TABLE `heard_about_resources` ( `id` int(11) NOT NULL AUTO_INCREMENT, `description` varchar(255) COLLATE utf8_unicode_ci DEFAULT NULL, `created_at` datetime DEFAULT NULL, `updated_at` datetime DEFAULT NULL, `is_approved` tinyint(1) NOT NULL DEFAULT '0', `is_internal_use_only` tinyint(1) NOT NULL DEFAULT '0', `units_count` int(11) DEFAULT NULL, PRIMARY KEY (`id`), KEY `index_heard_about_resources_on_description` (`description`))
CREATE TABLE `active_admin_comments` ( `id` int(11) NOT NULL AUTO_INCREMENT, `resource_id` int(11) NOT NULL, `resource_type` varchar(255) COLLATE utf8_unicode_ci NOT NULL, `author_id` int(11) DEFAULT NULL, `author_type` varchar(255) COLLATE utf8_unicode_ci DEFAULT NULL, `body` text COLLATE utf8_unicode_ci, `created_at` datetime NOT NULL, `updated_at` datetime NOT NULL, `namespace` varchar(255) COLLATE utf8_unicode_ci DEFAULT NULL, PRIMARY KEY (`id`), KEY `index_active_admin_comments_on_author_type_and_author_id` (`author_type`,`author_id`), KEY `index_active_admin_comments_on_namespace` (`namespace`), KEY `index_admin_notes_on_resource_type_and_resource_id` (`resource_type`,`resource_id`))
CREATE TABLE `delayed_jobs` ( `id` int(11) NOT NULL AUTO_INCREMENT, `priority` int(11) NOT NULL DEFAULT '0', `attempts` int(11) NOT NULL DEFAULT '0', `handler` text COLLATE utf8_unicode_ci NOT NULL, `last_error` text COLLATE utf8_unicode_ci, `run_at` datetime DEFAULT NULL, `locked_at` datetime DEFAULT NULL, `failed_at` datetime DEFAULT NULL, `locked_by` varchar(255) COLLATE utf8_unicode_ci DEFAULT NULL, `queue` varchar(255) COLLATE utf8_unicode_ci DEFAULT NULL, `created_at` datetime DEFAULT NULL, `updated_at` datetime DEFAULT NULL, PRIMARY KEY (`id`), KEY `delayed_jobs_priority` (`priority`,`run_at`))
CREATE TABLE `components_containers` ( `container_id` int(11) DEFAULT NULL, `component_id` int(11) DEFAULT NULL, KEY `component_id` (`component_id`), KEY `container_id` (`container_id`), CONSTRAINT `components_containers_ibfk_1` FOREIGN KEY (`container_id`) REFERENCES `containers` (`id`), CONSTRAINT `components_containers_ibfk_2` FOREIGN KEY (`component_id`) REFERENCES `components` (`id`))
CREATE TABLE `index_destinations` ( `id` int(11) NOT NULL AUTO_INCREMENT, `nickname` varchar(255) COLLATE utf8_unicode_ci DEFAULT NULL, `hostname` varchar(255) COLLATE utf8_unicode_ci DEFAULT 'localhost', `port` varchar(255) COLLATE utf8_unicode_ci DEFAULT '8080', `protocol` varchar(255) COLLATE utf8_unicode_ci DEFAULT 'http', `context` varchar(255) COLLATE utf8_unicode_ci DEFAULT 'solr', `created_at` datetime NOT NULL, `updated_at` datetime NOT NULL, `bibls_count` int(11) DEFAULT NULL, `units_count` int(11) DEFAULT NULL, `components_count` int(11) DEFAULT NULL, PRIMARY KEY (`id`))
