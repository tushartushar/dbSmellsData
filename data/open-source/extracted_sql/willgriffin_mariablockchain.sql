select vout_id from transactions_vouts where transaction_id = ? and n = ?
select sum(total) from (
select account_id from accounts where name = ?
CREATE TABLE `transactions_vouts_addresses` ( `vout_address_id` int(11) NOT NULL AUTO_INCREMENT, `vout_id` int(11) DEFAULT NULL, `address_id` int(11) DEFAULT NULL, PRIMARY KEY (`vout_address_id`), KEY `address_id` (`address_id`), KEY `vout_id` (`vout_id`))
CREATE TABLE `addresses` ( `address_id` int(11) NOT NULL AUTO_INCREMENT, `account_id` int(11) DEFAULT NULL, `address` varchar(60) DEFAULT NULL, `ismine` tinyint(1) DEFAULT NULL, `isscript` tinyint(1) DEFAULT NULL, `pubkey` varchar(255) DEFAULT NULL, `iscompressed` tinyint(1) DEFAULT NULL, `archived` tinyint(4) DEFAULT '0', `type` varchar(8) DEFAULT NULL, `type_id` int(11) DEFAULT NULL, PRIMARY KEY (`address_id`), UNIQUE KEY `address` (`address`), KEY `addr` (`address`(10)))
select * from addresses where address_id = ?
update transactions_vouts set spentat = null  where txid = ?
update transactions_vouts set transaction_id = ?, txid = ? where vout_id = ?
CREATE TABLE `transactions` ( `transaction_id` int(11) NOT NULL AUTO_INCREMENT, `amount` bigint(20) DEFAULT NULL, `blockhash` varchar(255) DEFAULT NULL, `txid` varchar(255) DEFAULT NULL, `inwallet` tinyint(1) DEFAULT NULL, `blocktime` timestamp NOT NULL DEFAULT '0000-00-00 00:00:00', `last_updated` timestamp NOT NULL DEFAULT '0000-00-00 00:00:00', `fee` int(11) DEFAULT NULL, `block_id` int(11) DEFAULT '0', `version` int(11) DEFAULT NULL, `locktime` int(32) DEFAULT NULL, `time` timestamp NOT NULL DEFAULT '0000-00-00 00:00:00', PRIMARY KEY (`transaction_id`), KEY `txid` (`txid`))
CREATE TABLE `blocks` ( `block_id` int(11) NOT NULL AUTO_INCREMENT, `hash` varchar(255) DEFAULT NULL, `size` int(11) DEFAULT NULL, `height` int(11) DEFAULT NULL, `version` double DEFAULT NULL, `merkleroot` varchar(255) DEFAULT NULL, `time` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, `nonce` int(11) DEFAULT NULL, `bits` varchar(16) DEFAULT NULL, `difficulty` double DEFAULT NULL, `previousblockhash` varchar(255) DEFAULT NULL, `nextblockhash` varchar(255) DEFAULT NULL, `previous_block_id` int(11) DEFAULT NULL, `next_block_id` int(11) DEFAULT NULL, `last_updated` timestamp NOT NULL DEFAULT '0000-00-00 00:00:00', PRIMARY KEY (`block_id`), KEY `previous_block_id` (`previous_block_id`), KEY `next_block_id` (`next_block_id`), KEY `hash` (`hash`(20)), KEY `previousblockhash` (`hash`(20)), KEY `nextblockhash` (`hash`(20)))
select block_id from blocks where hash = ?', ['s', $blockhash]);
CREATE TABLE `transactions_vins` ( `vin_id` int(11) NOT NULL AUTO_INCREMENT, `transaction_id` int(11) DEFAULT NULL, `txid` varchar(255) DEFAULT NULL, `vout` int(11) DEFAULT NULL, `asm` varchar(255) DEFAULT NULL, `hex` varchar(255) DEFAULT NULL, `sequence` int(10) unsigned DEFAULT NULL, `vout_id` int(11) DEFAULT NULL, `coinbase` varchar(255) DEFAULT NULL, PRIMARY KEY (`vin_id`), KEY `vout_id` (`vout_id`), KEY `transaction_id` (`transaction_id`))
select transaction_id from transactions where txid = ?
CREATE TABLE `transactions_vouts` ( `vout_id` int(11) NOT NULL AUTO_INCREMENT, `transaction_id` int(11) DEFAULT NULL, `value` bigint(20) DEFAULT NULL, `n` int(11) DEFAULT NULL, `hexgz` mediumblob DEFAULT NULL, `reqSigs` int(11) DEFAULT NULL, `type` varchar(64) DEFAULT NULL, `txid` varchar(255) DEFAULT NULL, `coinbase` varchar(255) DEFAULT NULL, `spentat` varchar(128) DEFAULT NULL, `spentat_transaction_id` int(11) DEFAULT NULL, PRIMARY KEY (`vout_id`), UNIQUE KEY `txid_n` (`txid`,`n`), KEY `transaction_id` (`transaction_id`))
select transaction_id from transactions where txid = ?';
update transactions_vouts set spentat = ?  where txid = ? and n = ?
CREATE TABLE `addresses_aliases` ( `alias_id` int(11) NOT NULL AUTO_INCREMENT, `target_address_id` int(11) NOT NULL, `address_id` int(11) NOT NULL, `secret_id` int(11) DEFAULT NULL, `archived` tinyint(4) DEFAULT '0', `created` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, PRIMARY KEY (`alias_id`), KEY `address_id` (`target_address_id`))
update transactions set block_id = ?, blockhash = ?, time = ?, last_updated = now where transaction_id = ?
update transactions_vouts set spentat = ?  where vout_id = ?
CREATE TABLE `accounts` ( `account_id` int(11) NOT NULL AUTO_INCREMENT, `name` varchar(128) DEFAULT NULL, PRIMARY KEY (`account_id`))
CREATE TABLE `accounts_addresses` ( `account_address_id` int(11) NOT NULL AUTO_INCREMENT, `account` varchar(128) DEFAULT NULL, `address` varchar(128) DEFAULT NULL, `wallet_updated` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, `updated` timestamp NOT NULL DEFAULT '0000-00-00 00:00:00', `created` timestamp NOT NULL DEFAULT '0000-00-00 00:00:00', PRIMARY KEY (`account_address_id`))
