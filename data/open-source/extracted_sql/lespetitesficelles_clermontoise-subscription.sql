CREATE TABLE `donation`( `id` INTEGER NOT NULL AUTO_INCREMENT, `name` VARCHAR(255), `email` VARCHAR(255), `amount` FLOAT NOT NULL, `payment_id` INTEGER NOT NULL, PRIMARY KEY (`id`), INDEX `donation_fi_f8ae68` (`payment_id`), CONSTRAINT `donation_fk_f8ae68` FOREIGN KEY (`payment_id`) REFERENCES `payment` (`id`))
CREATE TABLE `shop`( `id` INTEGER NOT NULL AUTO_INCREMENT, `firstname` VARCHAR(255) NOT NULL, `lastname` VARCHAR(255) NOT NULL, `postcode` DECIMAL(5) NOT NULL, `city` VARCHAR(255) NOT NULL, `email` VARCHAR(255) NOT NULL, `amount` FLOAT DEFAULT 10 NOT NULL, `size` VARCHAR(3) DEFAULT 'm' NOT NULL, `payment_id` INTEGER NOT NULL, PRIMARY KEY (`id`), INDEX `shop_fi_f8ae68` (`payment_id`), CONSTRAINT `shop_fk_f8ae68` FOREIGN KEY (`payment_id`) REFERENCES `payment` (`id`))
CREATE TABLE `ville`( `id` INTEGER NOT NULL AUTO_INCREMENT, `postal` VARCHAR(6) NOT NULL, `nom` VARCHAR(255) NOT NULL, PRIMARY KEY (`id`), INDEX `ville_i_fce36e` (`postal`))
CREATE TABLE `team_has_payment`( `team_id` INTEGER NOT NULL, `payment_id` INTEGER NOT NULL, PRIMARY KEY (`team_id`,`payment_id`), INDEX `team_has_payment_fi_f8ae68` (`payment_id`), CONSTRAINT `team_has_payment_fk_f0e437` FOREIGN KEY (`team_id`) REFERENCES `team` (`id`) ON DELETE CASCADE, CONSTRAINT `team_has_payment_fk_f8ae68` FOREIGN KEY (`payment_id`) REFERENCES `payment` (`id`) ON DELETE CASCADE)
CREATE TABLE `runner`( `id` INTEGER NOT NULL AUTO_INCREMENT, `firstname` VARCHAR(255) NOT NULL, `lastname` VARCHAR(255) NOT NULL, `postcode` DECIMAL(5) NOT NULL, `city` VARCHAR(255) NOT NULL, `email` VARCHAR(255), `phone` VARCHAR(10), `birthday` DATE NOT NULL, `team_id` INTEGER, `coach` TINYINT(1) DEFAULT 0 NOT NULL, `run` VARCHAR(15) DEFAULT 'libre' NOT NULL, `licence_type` VARCHAR(15) DEFAULT 'aucun' NOT NULL, `licence_filename` VARCHAR(40), `size` VARCHAR(3) DEFAULT 's' NOT NULL, `race_number` INTEGER, `ready` TINYINT(1) DEFAULT 0 NOT NULL, `valid` TINYINT(1) DEFAULT 0 NOT NULL, `notified_at` DATE, `hash` VARCHAR(40) NOT NULL, `password` VARCHAR(40) NOT NULL, `created_at` DATETIME, `updated_at` DATETIME, PRIMARY KEY (`id`), UNIQUE INDEX `runner_u_90f52b` (`hash`), UNIQUE INDEX `runner_u_8f7728` (`race_number`), INDEX `runner_i_3a0ca0` (`firstname`), INDEX `runner_fi_f0e437` (`team_id`), CONSTRAINT `runner_fk_f0e437` FOREIGN KEY (`team_id`) REFERENCES `team` (`id`))
CREATE TABLE `payment`( `id` INTEGER NOT NULL AUTO_INCREMENT, `typeof` VARCHAR(10) NOT NULL, `payment_date` DATETIME, `status` VARCHAR(6) DEFAULT 'wait' NOT NULL, `amount` FLOAT NOT NULL, `bank_ref` VARCHAR(50), `hash` VARCHAR(40) NOT NULL, `created_at` DATETIME, `updated_at` DATETIME, PRIMARY KEY (`id`), UNIQUE INDEX `payment_u_90f52b` (`hash`), INDEX `payment_i_d402b5` (`status`))
CREATE TABLE `runner_has_payment`( `runner_id` INTEGER NOT NULL, `payment_id` INTEGER NOT NULL, PRIMARY KEY (`runner_id`,`payment_id`), INDEX `runner_has_payment_fi_f8ae68` (`payment_id`), CONSTRAINT `runner_has_payment_fk_c18c6e` FOREIGN KEY (`runner_id`) REFERENCES `runner` (`id`) ON DELETE CASCADE, CONSTRAINT `runner_has_payment_fk_f8ae68` FOREIGN KEY (`payment_id`) REFERENCES `payment` (`id`) ON DELETE CASCADE)
CREATE TABLE `customization_has_payment`( `customization_id` INTEGER NOT NULL, `payment_id` INTEGER NOT NULL, PRIMARY KEY (`customization_id`,`payment_id`), INDEX `customization_has_payment_fi_f8ae68` (`payment_id`), CONSTRAINT `customization_has_payment_fk_442066` FOREIGN KEY (`customization_id`) REFERENCES `customization` (`id`) ON DELETE CASCADE, CONSTRAINT `customization_has_payment_fk_f8ae68` FOREIGN KEY (`payment_id`) REFERENCES `payment` (`id`) ON DELETE CASCADE)
CREATE TABLE `customization`( `id` INTEGER NOT NULL AUTO_INCREMENT, `team_id` INTEGER NOT NULL, `amount` FLOAT DEFAULT 10 NOT NULL, `number` INTEGER NOT NULL, `typeof` VARCHAR(8) DEFAULT 'printing' NOT NULL, `model` VARCHAR(3) DEFAULT 'new' NOT NULL, `custom_filename` VARCHAR(40) NOT NULL, `valid` TINYINT(1) DEFAULT 0 NOT NULL, PRIMARY KEY (`id`), INDEX `customization_fi_f0e437` (`team_id`), CONSTRAINT `customization_fk_f0e437` FOREIGN KEY (`team_id`) REFERENCES `team` (`id`))
CREATE TABLE `team`( `id` INTEGER NOT NULL AUTO_INCREMENT, `name` VARCHAR(255) NOT NULL, `category` VARCHAR(10) DEFAULT 'copines' NOT NULL, `hash` VARCHAR(40) NOT NULL, `created_at` DATETIME, `updated_at` DATETIME, PRIMARY KEY (`id`), UNIQUE INDEX `team_u_d94269` (`name`), UNIQUE INDEX `team_u_90f52b` (`hash`))
