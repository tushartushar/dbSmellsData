CREATE TABLE IF NOT EXISTS OrderItem ( id bigint(20) NOT NULL AUTO_INCREMENT, order_id bigint(20) NOT NULL, sku_id bigint (20) NULL, product_id bigint (20) NULL, quantity int (11) NULL, price double NULL, PRIMARY KEY (id))
CREATE TABLE IF NOT EXISTS Category_Category ( parentCategoryId bigint(20) NOT NULL, childCategoryId bigint(20) NOT NULL, orderIdx int(11) NOT NULL, PRIMARY KEY (parentCategoryId,orderIdx))
CREATE TABLE IF NOT EXISTS User ( id bigint(20) NOT NULL AUTO_INCREMENT, birthDate datetime NULL, creationDate datetime NOT NULL, updateDate datetime NULL, disabled bit(1) NULL, activated bit(1) NULL, newslettersSubscribed bit(1) NULL, actionToken BINARY (16) NULL, firstname varchar(50) NOT NULL, lastname varchar(50) NOT NULL, gender varchar(30) NOT NULL, login varchar(255) NOT NULL, password varchar(100) NOT NULL, phoneNumber varchar(30) NULL, address_id bigint(20) NULL, deliveryAddress_id bigint(20) NULL, preferredLocale varchar(25) NULL, PRIMARY KEY (id), UNIQUE KEY UK_Login (login))
CREATE TABLE IF NOT EXISTS Address ( id bigint(20) NOT NULL AUTO_INCREMENT, city varchar(255) NOT NULL, street varchar(255)NOT NULL, zipCode varchar (10) NOT NULL, countryIso3Code varchar (3) NOT NULL, gender varchar(30) NOT NULL, firstname varchar(50) NOT NULL, lastname varchar(50) NOT NULL, company varchar(100) NULL, PRIMARY KEY (id))
CREATE TABLE IF NOT EXISTS Category_Presentation ( catalogItemId bigint(20) NOT NULL, presentationId bigint(20) NOT NULL, PRIMARY KEY (catalogItemId,presentationId))
CREATE TABLE IF NOT EXISTS Discount_Presentation ( catalogItemId bigint(20) NOT NULL, presentationId bigint(20) NOT NULL, PRIMARY KEY (catalogItemId,presentationId))
CREATE TABLE IF NOT EXISTS Catalog ( id bigint(20) NOT NULL AUTO_INCREMENT, description varchar(255) NULL, disabled bit(1) NULL, endDate datetime NULL, name varchar(50) NOT NULL, startDate datetime NULL, PRIMARY KEY (id))
CREATE TABLE IF NOT EXISTS Product_SKU ( productId bigint(20) NOT NULL, skuId bigint(20) NOT NULL, orderIdx int(11) NOT NULL, PRIMARY KEY (productId,orderIdx))
CREATE TABLE IF NOT EXISTS MailTemplate ( id bigint(20) NOT NULL AUTO_INCREMENT, name varchar(100) NOT NULL, locale varchar(25) NULL, content TEXT NOT NULL, subject varchar (255) NOT NULL, creationDate datetime NOT NULL, updateDate datetime NULL, PRIMARY KEY (id), UNIQUE KEY UK_MailTemplate_name (name,locale))
CREATE TABLE IF NOT EXISTS Category_Product ( categoryId bigint(20) NOT NULL, productId bigint(20) NOT NULL, orderIdx int(11) NOT NULL, PRIMARY KEY (categoryId,orderIdx))
CREATE TABLE IF NOT EXISTS Role ( id bigint(20) NOT NULL AUTO_INCREMENT, name varchar(255) NOT NULL, PRIMARY KEY (id), UNIQUE KEY UK_Role_name (name))
CREATE TABLE IF NOT EXISTS Presentation ( id bigint(20) NOT NULL AUTO_INCREMENT, displayName varchar(255) NULL, promotion varchar(255) NULL, features tinyblob, locale varchar(25) NOT NULL, shortDescription varchar(1000) NULL, mediumDescription varchar(2000) NULL, longDescription varchar(5000) NULL, largeImage_id bigint(20) NULL, smallImage_id bigint(20) NULL, thumbnail_id bigint(20) NULL, video_id bigint(20) NULL, PRIMARY KEY (id))
CREATE TABLE IF NOT EXISTS SKU_Discount ( skuId bigint(20) NOT NULL, discountId bigint(20) NOT NULL, orderIdx int(11) NOT NULL, PRIMARY KEY (skuId,orderIdx))
CREATE TABLE IF NOT EXISTS Discount ( id bigint(20) NOT NULL AUTO_INCREMENT, description varchar(255) NULL, disabled bit(1) NULL, endDate datetime NULL, name varchar(50) NOT NULL, startDate datetime NULL, discountValue double NULL, triggerValue double NULL, triggerRule varchar(50) NULL, type varchar(50) NULL, applicableTo varchar(10) NOT NULL , uniqueUse bit(1) NULL, usesPerCustomer int(11) NULL, voucherCode varchar(100) NULL, PRIMARY KEY (id))
CREATE TABLE IF NOT EXISTS Category ( id bigint(20) NOT NULL AUTO_INCREMENT, description varchar(255) NULL, disabled bit(1) NULL, endDate datetime NULL, name varchar(50) NOT NULL, startDate datetime NULL, PRIMARY KEY (id))
CREATE TABLE IF NOT EXISTS Catalog_Presentation ( catalogItemId bigint(20) NOT NULL, presentationId bigint(20) NOT NULL, PRIMARY KEY (catalogItemId,presentationId))
CREATE TABLE IF NOT EXISTS Orders ( id bigint(20) NOT NULL AUTO_INCREMENT, user_id bigint(20) NOT NULL, transactionId VARCHAR(255) NULL, deliveryAddress_id bigint(20) NULL, billingAddress_id bigint(20) NULL, status varchar(30) NOT NULL, creationDate datetime NOT NULL, updateDate datetime NULL, paymentDate datetime NULL, deliveryDate datetime NULL, parcelTrackingKey VARCHAR(50) NULL, price double NULL, PRIMARY KEY (id))
CREATE TABLE IF NOT EXISTS Product ( id bigint(20) NOT NULL AUTO_INCREMENT, description varchar(255) NULL, disabled bit(1) NULL, endDate datetime NULL, name varchar(50) NOT NULL, startDate datetime NULL, PRIMARY KEY (id))
CREATE TABLE IF NOT EXISTS Presentation_Feature ( presentationId bigint(20) NOT NULL, name varchar(255) NOT NULL, value varchar(255) NULL, PRIMARY KEY (presentationId,name))
CREATE TABLE IF NOT EXISTS OrderDiscount( order_id bigint(20) NOT NULL, discount_id bigint(20) NOT NULL, discountValue double NULL, UNIQUE KEY UK_Order_discountIds (order_id,discount_id))
CREATE TABLE IF NOT EXISTS Product_Discount ( productId bigint(20) NOT NULL, discountId bigint(20) NOT NULL, orderIdx int(11) NOT NULL, PRIMARY KEY (productId,orderIdx))
CREATE TABLE IF NOT EXISTS SKU ( id bigint(20) NOT NULL AUTO_INCREMENT, description varchar(255) NULL, disabled bit(1) NULL, endDate datetime NULL, name varchar(50) NOT NULL, startDate datetime NULL, currency varchar(3) NULL, price double NULL, quantity int(11) NULL, reference varchar(50) NULL, threshold int(11) NULL, PRIMARY KEY (id))
CREATE TABLE IF NOT EXISTS Newsletter ( id bigint(20) NOT NULL AUTO_INCREMENT, name varchar(100) NOT NULL, mailTemplateName varchar(100) NOT NULL, creationDate datetime NOT NULL, updateDate datetime NULL, dueDate datetime NULL, PRIMARY KEY (id))
CREATE TABLE IF NOT EXISTS User_Role ( userId bigint(20) NOT NULL, roleId bigint(20) NOT NULL, PRIMARY KEY (userId,roleId))
CREATE TABLE IF NOT EXISTS Media ( id bigint(20) NOT NULL AUTO_INCREMENT, uri varchar(255) NOT NULL, PRIMARY KEY (id))
select password from User where login = ? and (disabled is null or disabled = 0) and activated = 1
CREATE TABLE IF NOT EXISTS MailTemplate_Media ( mailTemplateId bigint(20) NOT NULL, mediaId bigint(20) NOT NULL, PRIMARY KEY (mailTemplateId,mediaId))
CREATE TABLE IF NOT EXISTS Presentation_Media ( presentationId bigint(20) NOT NULL, mediaId bigint(20) NOT NULL, orderIdx int(11) NOT NULL, PRIMARY KEY (presentationId,orderIdx))
CREATE TABLE IF NOT EXISTS Catalog_Category ( catalogId bigint(20) NOT NULL, categoryId bigint(20) NOT NULL, orderIdx int(11) NOT NULL, PRIMARY KEY (catalogId,orderIdx))
CREATE TABLE IF NOT EXISTS SKU_Presentation ( catalogItemId bigint(20) NOT NULL, presentationId bigint(20) NOT NULL, PRIMARY KEY (catalogItemId,presentationId))
CREATE TABLE IF NOT EXISTS Product_Presentation ( catalogItemId bigint(20) NOT NULL, presentationId bigint(20) NOT NULL, PRIMARY KEY (catalogItemId,presentationId))
